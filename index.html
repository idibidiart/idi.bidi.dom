<!DOCTYPE html>
<html>
<head>
  <meta charset='utf-8'>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>idibidiart/idom @ GitHub</title>
 
  <script src='idom.js'></script>

  <!-- github styles -->
 
  <style>
	body{
	position: absolute;
	width: 100%;
	padding: 0px;
	margin: 0px;
	font-family: Helvetica, Arial, FreeSans, san-serif;
	}
	
	#banner{
	position: relative;

	height: 149px;
	width: 149px;
	overflow:hidden;
	padding: 0px;
	float: right;
	margin-right: 0px;
	}
	
	#banner a{
	
	display: block;
	width: 190px;
	font-size: 14px;
	font-family: Frutiger, "Frutiger Linotype", Univers, Calibri, "Gill Sans", "Gill Sans MT",
	"Myriad Pro", Myriad, "DejaVu Sans Condensed", "Liberation Sans", "Nimbus Sans L", Tahoma,
	Geneva, "Helvetica Neue", Helvetica, Arial, sans serif;
	background-color: #333;
	color: #FFF;
	word-spacing: 2px;
	text-decoration: none;
	padding: 5px 15px 5px 25px;
	
	position:relative;
	left: 20px;
	top: -37px;
	text-align: center;
	
	-moz-transform-origin: 0 0 ;
	-moz-transform:rotate(45deg);
	-moz-box-shadow: 1px 1px 5px 1px #666;
	
	-webkit-transform-origin: 0 0 ;
	-webkit-transform:rotate(45deg);
	-webkit-box-shadow: 1px 1px 5px 1px #666;
	
	-ms-transform-origin: 0 0 ;
	-ms-transform:rotate(45deg);
	-ms-box-shadow: 1px 1px 5px 1px #666;
	
	transform-origin: 0 0 ;
	transform:rotate(45deg);
	box-shadow: 1px 1px 5px 1px #666;
	
	background-image: linear-gradient(bottom, #000000 3%, #666666 5%, #000000 7%, #000000 93%, #666666 95%, #000000 97%);
	background-image: -o-linear-gradient(bottom, #000000 3%, #666666 5%, #000000 7%, #000000 93%, #666666 95%, #000000 97%);
	background-image: -moz-linear-gradient(bottom, #000000 3%, #666666 5%, #000000 7%, #000000 93%, #666666 95%, #000000 97%);
	background-image: -webkit-linear-gradient(bottom, #000000 3%, #666666 5%, #000000 7%, #000000 93%, #666666 95%, #000000 97%);
	background-image: -ms-linear-gradient(bottom, #000000 3%, #666666 5%, #000000 7%, #000000 93%, #666666 95%, #000000 97%);
	
	background-image: -webkit-gradient(
	linear,
	left bottom,
	left top,
	color-stop(0.03, #000000),
	color-stop(0.05, #666666),
	color-stop(0.07, #000000),
	color-stop(0.93, #000000),
	color-stop(0.95, #666666),
	color-stop(0.97, #000000)
	);
	
	}	
    
    #container {
      margin: 0 auto;
      width: 700px;
    }
    h1 { font-size: 3.8em; color: #8073ab; margin-bottom: 3px; }
    h1 .small { font-size: 0.4em; }
    h1 a { text-decoration: none }
    h2 { font-size: 1.5em; color: #8073ab; }
    h3 { text-align: center; color: #8073ab; }
    a { color: #8073ab; }
    .description { font-size: 1.2em; margin-bottom: 30px; margin-top: 30px; font-style: italic;}
    .download { float: right; }
    pre { padding-left: 15px; word-break: break; font-size: 15px}
    hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
    .footer { text-align:center; padding-top:30px; font-style: italic; }
  
  </style>
  
  
</head>

<body style='color: black; background-color: snow'>
	<div id="banner"><a href="http://github.com/idibidiart/idi.bidi.dom">Spoon me on GitHub</a></div>
  
  <div id="container">

    <div class="download">
      <a href="http://github.com/idibidiart/idi.bidi.dom/zipball/master">
        <img border="0" width="90" src="http://github.com/images/modules/download/zip.png"></a>
      <a href="http://github.com/idibidiart/idi.bidi.dom/tarball/master">
        <img border="0" width="90" src="http://github.com/images/modules/download/tar.png"></a>
    </div>

    <h1><a href="http://github.com/idibidiart/idi.bidi.dom">idom</a>
      <span class="small">by <a href="https://github.com/idibidiart">idibidiart</a></span></h1>

    <div class="description">
      New Way To Interact With The DOM
    </div>
</div>

<pre>

/*! idi.bidi.dom 
* 
* v0.09
*
* New Way To Interact With The DOM 
*
* Copyright (c) Marc Fawzi 2012
* 
* http://javacrypt.wordpress.com
*
* Apache License 2.0  
* 
* partly based on NattyJS, a BSD licensed precursor by the same author 
*
*/
 
<br>
<img src= "idom.png";/>
<br>
/* 
 * idi.bidi.dom - Anti-Templating Framework For Javascript -- offers a radically
 * different way for interfating with the DOM. In abstract terms, it takes the DOM 
 * and adds variables, variable memoization, encapsulation, multiple-inheritance and 
 * type polymorphism (with the Node Prototype as the user defined type) In logical 
 * terms, it offers a list-based API for creating, populating, and de-populating 
 * predetermined DOM structures with the ability to link, directly access, populate
 * and de-populate other predetermined DOM structures at any depth within them, thus 
 * giving us a simple and consistent alternative to the DOM's native API while allowing 
 * us to reduce the amount of HTML as well as separate the HTML from the presentation 
 * logic.
 *
 */
<br>
Example:
<br>
<div style='color: gray'>

&lt;!--************************************************* VIEW OBJECTS ***************************************************-->

&lt;div style='display: none'>

&lt;!-- ANY ELEMENT CAN BE A NODE AS LONG AS IT HAS JUST ONE CHILD AT TIME OF CACHING
 (use block level child element to contain other elements) -->
 
&lt;!-- Start of Node -->
&lt;div idom-node-id='teamInfo' class='idom$teamsClass' style='background-color: idom$bgColorTeams'>
	
	&lt;!-- Start of Node Prototype -->	
	&lt;div class='idom$teamsProtoClass' style='background-color: idom$instanceColorTeams;'>
		&lt;div style='padding: 5px;'>idom$caption&lt;/div>
		
		&lt;!-- @idom userInfo -->
				 
	&lt;/div> 
	&lt;!-- End of Node Prototype -->
	
&lt;/div>
&lt;!-- End of Node -->

&lt;!-- Start of Node -->
&lt;div idom-node-id='userInfo' class='idom$usersClass' style='background-color: idom$bgColorUsers'>
	
	&lt;!-- Start of Node Prototype -->
	&lt;div class='idom$usersProtoClass' style='border: idom$borderStyle;'> 
		
		&lt;div onclick='idom$someHandler'>user: idom$username&nbsp;&nbsp;&nbsp;id: idom$id&lt;/div>
		
		&lt;div class='idom$usersExtendedClass' style='background-color: idom$bgColorUsersExtended; display: idom$displayStatus'> 
		
			&lt;div>last name: idom$lastName&lt;br>work: idom$work&lt;/div>
				
		&lt;/div>
				
	&lt;/div>
	&lt;!-- End of Node Prototype -->
	
&lt;/div>
&lt;!-- End of Node -->

&lt;/div>

</div>
</pre>

<div id='mainDiv' style='height: 600px; margin-left: 15px;'>
<div>

<p style='font-size: 24px'>Click on any user below to see the event handler for the target element in action</p>

<button onclick='button1()'>Click to disable event handling on 2nd user in clone 2</button>
<button onclick='button2()'>Click to enable event handling on 2nd user in clone 2</button>
<br><br>
<button onclick='button3()'>dePopulate() clone 3</button>
<button onclick='button4()'>Repopulate clone 3</button>

<br>
<br>
Randomly colored
<br>
<br>

</div>
	
</div>


<!--************************************************* INTERFACE OBJECT ***********************************************-->
<script type="text/javascript" src="jsonData.js"></script>

<!--************************************************* VIEW OBJECTS ***************************************************-->
<style>
.teams1 {
	float: left; 
	width: auto; 
	height: auto;
	margin-left: 0px;
	margin-top: 0px;
	padding: 0px;
	border-radius: 5px;
}
.teams2 {
	float: left; 
	width: auto; 
	height: auto;
	margin-left: 20px;
	margin-top: 15px;
	padding: 0px;
	border-radius: 5px;
	
}
.teams3 {
	float: left; 
	width: auto; 
	height: auto;
	margin-left: 20px;
	margin-top: 30px;
	padding: 0px;
	border-radius: 5px;
}
.teams4 {
	float: left; 
	width: auto; 
	height: auto;
	margin-left: 20px;
	margin-top: 45px;
	padding: 0px;
	border-radius: 5px;
}

.teamsProto {
	
	padding: 20px; 
	border-radius: 10px;
	margin: 10px;
	height: 390px; 
	width: 60%;
}

.users {
	border-radius: 10px;
	height: 300px;
	width: 240px;
	padding: 10px;
}

.usersProto {
	
	box-sizing: border-box ; 
	margin: 2px; 
	border-radius: 5px;
	padding: 5px;
	padding-top: 15px;'
}


.usersExtended {
	
width: 300px;
height: 50px;
padding: 5px;
margin-left: 20px;
border-radius: 5px;
position: absolute;

}



</style>

<div style='display: none'>
<!-- Start of Node -->
<div idom-node-id='teamInfo' class='idom$teamsClass' style='background-color: idom$bgColorTeams'>
	
	<!-- Start of Node Prototype -->	
	<div class='idom$teamsProtoClass' style='background-color: idom$instanceColorTeams;'>
		<div style='padding: 5px;'>idom$caption</div>
		
		<!-- @idom userInfo -->
				 
	</div> 
	<!-- End of Node Prototype -->
	
</div>
<!-- End of Node -->

<!-- Start of Node -->
<div idom-node-id='userInfo' class='idom$usersClass' style='background-color: idom$bgColorUsers'>
	
	<!-- Start of Node Prototype -->
	<div class='idom$usersProtoClass' style='border: idom$borderStyle;'> 
		
		<div onclick='idom$someHandler'>user: idom$username&nbsp;&nbsp;&nbsp;id: idom$id</div>
		
		<div class='idom$usersExtendedClass' style='background-color: idom$bgColorUsersExtended; display: idom$displayStatus'> 
		
			<div>last name: idom$lastName<br>work: idom$work</div>
				
		</div>
				
	</div>
	<!-- End of Node Prototype -->
	
</div>
<!-- End of Node -->

</div>

<br>
<div style='width: 1280px; overflow: hidden'>
<pre>


</pre>	
</div>

<script>
/*********************************************** PRESENTER *************************************************************/

/*************************** ALL SELECTOR DRIVEN LOGIC IS CONTAINED WITHIN THE PRESENTER ***********************************/

//cache DOM elements with idom-node-id (i.e. all node prototypes) and supply values for init() variables (i$var) if any (as simple JSON)
idom.init();	

(function() {
	
	for (m = 0; m < jsonData.teams.length; m++) {
		
	//populate the Node Prototype of the Linked Node before the Host Node 
	 
	for (n = 0; n < jsonData.teams[m].members.length; n++) {
	
	    // the next-level-up linked node is userInfo 
		document.querySelector('[idom-node-id=userInfo]').idom$('clone' + Number(m + 1),
			{
				usersClass: 'users',
				usersProtoClass: 'usersProto',
				usersExtendedClass: 'usersExtended' ,
				borderStyle: 'none',
				displayStatus: 'none',
				bgColorUsers: rndColor(),
				bgColorUsersExtended: rndColor(),
				username: jsonData.teams[m].members[n].username,
				id: jsonData.teams[m].members[n].id,
				lastName: jsonData.teams[m].members[n].otherData.lastName,
				work: jsonData.teams[m].members[n].otherData.work,
				// we can have as many event handlers on or within a node but here we're just using the 
				// same one here, on user's first name and id 
				someHandler: 'idom.eventHandler(event, this, changeInstance)' 
				// event handler can be removed by simply setting someHandler to null
			}, 
			{
				// default mode is replace...
				mode: 'append',
				instanceId: 'user' + n
			})
	
	}
	
	// perform replace on the Host Node (linked node gets re/linked with each idom$() call)
	// and populate again each time before making a new clone of it
	document.querySelector('[idom-node-id=teamInfo]').idom$('clone' + Number(m + 1),
		{
			teamsClass: 'teams' + Number(m + 1),
			teamsProtoClass: 'teamsProto',
			bgColorTeams: rndColor(),
			caption: jsonData.teams[m].caption,
			instanceColorTeams: rndColor() 
		}, 
		{	
			instanceId: 'teamInfo' 
		})		

	// at this point the teamInfo div is populated with the idom$ data and the content of the linked userInfo node 
	// so we may now clone it and provide a uid for the clone (e.g. 'clone1')
	var clonedEl = document.querySelector('[idom-node-id=teamInfo]').idom$clone('clone' + Number(m + 1))

	//insert cloned node into body
	document.querySelector('#mainDiv').appendChild(clonedEl);
	
	// normally, we'd have to call idom$dePopulate() on the host node (so we may start with no instances in the next 
	// iteration) but in this case the host node's only populated instance is being replaced each time (default mode is 
	// 'replace') so no need to dePopulate it
	
	// dePopulate() the linked node so we can restart with new data 
	document.querySelector('[idom-node-id=userInfo]').idom$dePopulate()
	
	}

}())

var toggle = {};

var Instance = {};

// the event handler is defined here on each instance of the linked node that's now inside 
// the cloned node, but it can also be defined anywhere within any node (and anywhere within any linked nodes within
// it) 

// About Events:
// If a handler is defined on the node it will only have access to the node id. If it's defined on or in the
// node prototype it will have access to the instance id

// The context of 'this' inside the handler is the element the event is defined on 

// event handlers that are not defined using inline event handlers (like onclick, onmouseover, etc) are not handled by 
// idom at this time. Finding and cloning all event handlers that are attached via different means, like jQuery, 
// will be supported in the future 

function changeInstance(event, nodeId, instanceId, cloneId) {
	
	// normally, a unique key is the combination of nodeId + instanceId + cloneId 
	// which assumes cloneId is globally unique (user enforced), node is unique within 
	// the clone (framework enforced) and instanceId is unique within the node (user enforced)
	// but in this case the nodeId contains the cloneId so we're safe...
	
	if (Instance[nodeId]) {
		
		document.querySelector('[idom-node-id="' + nodeId + '"]').idom$(
				{
					borderStyle: 'none',
					displayStatus: 'none'
				}, 
				{
					// instanceId in settings is the same as the original populated node 
					// without link/clone references (they're added automatically)
					
				    // new instance id (same as old)
					instanceId: idom.baseSelector(Instance[nodeId]),
					// target instance id (for instance to be replaced) 
					targetInstanceId: idom.baseSelector(Instance[nodeId])
				})
				
				toggle[Instance[nodeId]] = !toggle[Instance[nodeId]];	
				
	} 
	
	Instance[nodeId] = instanceId;
	
	toggle[Instance[nodeId]] = !toggle[Instance[nodeId]];
	
	
	if (toggle[Instance[nodeId]]) {
		
		// notice that we're only supplying the new/changed data (the delta not the whole set) for the idom$ variables 
		// in the node prototype. The idom$ variable values are persisted for each node (shared among original, linked 
		// and cloned versions of the populated node) with the key being a combination of the base node 
		// id, instance id (without the link/clone reference) and clone id 
		
		// directly accessing the linked node inside the cloned node (the linked can be nested anywhere in the
		// node prototype of the original node the clone is copied from)
		// when operating on a clone, we discard the cloneId argument
		
		document.querySelector('[idom-node-id="' + nodeId + '"]').idom$(
				{
					borderStyle: borderSelector(instanceId),
					displayStatus: 'block'
				}, 
				{
					// instanceId in settings is the same as the original populated node 
					// without link/clone references (they're added automatically)
					
				    // new instance id (same as old)
					instanceId: idom.baseSelector(instanceId),
					// target instance id (for instance to be replaced) 
					targetInstanceId: idom.baseSelector(instanceId)
				})
	} else {
		
		document.querySelector('[idom-node-id="' + nodeId + '"]').idom$(
				{
					borderStyle: 'none',
					displayStatus: 'none'
				}, 
				{
					// instanceId in settings is the same as the original populated node 
					// without link/clone references (they're added automatically)
					
					 // new instance id (same as old)
					instanceId: idom.baseSelector(instanceId),
					// target instance id (for instance to be replaced) 
					targetInstanceId: idom.baseSelector(instanceId)
				})
	}
}

function button1() {
	
	// notice that we're only supplying the new/changed data (the delta not the whole set) for the idom$ variables 
	// in the node prototype. The idom$ variable values are persisted for each node (shared among original, linked 
	// and cloned versions of the populated node) with the key being a combination of the base node 
	// id, instance id (without the link/clone reference) and clone id 	
	
	// directly accessing the linked node inside the cloned node (the linked can be nested anywhere in the
	// node prototype of the original node the clone is copied from)
	// when operating on a clone, we discard the cloneId argument
	
	document.querySelector('[idom-node-id="userInfo@cloned@clone2"]').idom$( 
		{
			someHandler: "" //null value removes the handler
		},
		{
			// instanceId in settings is the same as the original populated node 
			// without link/clone references (they're added automatically)
					
			instanceId: "user1",
			targetInstanceId: "user1"
		}
	
	)
}

function button2() {
	
	// notice that we're only supplying the new/changed data (the delta not the whole set) for the idom$ variables 
	// in the node prototype. The idom$ variable values are persisted for each node (shared among original, linked 
	// and cloned versions of the populated node) with the key being a combination of the base node 
	// id, instance id (without the link/clone reference) and clone id 
	
	// directly accessing the linked node inside the cloned node (the linked can be nested anywhere in the
	// node prototype of the original node the clone is copied from)
	// when operating on a clone, we discard the cloneId argument
	
	document.querySelector('[idom-node-id="userInfo@cloned@clone2"]').idom$( 
		{
			someHandler: "idom.eventHandler(event, this, changeInstance)" 
		},
		{
			// instanceId in settings is the same as the original populated node 
			// without link/clone references (they're added automatically)
					
			instanceId: "user1",
			targetInstanceId: "user1"
		}
	
	)
}

function button3() {
	
	// notice that we're only supplying the new/changed data (the delta not the whole set) for the idom$ variables 
	// in the node prototype. The idom$ variable values are persisted for each node (shared among original, linked 
	// and cloned versions of the populated node) with the key being a combination of the base node 
	// id, instance id (without the link/clone reference) and clone id 
	
	// delete content of the cloned node (including content of the cloned linked node)
	document.querySelector('[idom-node-id="teamInfo@cloned@clone3"]').idom$dePopulate()

}

function button4() {
	
	// delete content of the original Linked Node (outside the clone) 
	if (document.querySelector('[idom-node-id="userInfo"]').idom$isPopulated()) 
		document.querySelector('[idom-node-id="userInfo"]').idom$dePopulate()
		
	//Populate the Node Prototype of the original Linked Node  
	
	// notice that we're only supplying the new/changed data (the delta not the whole set) for the idom$ variables 
	// in the node prototype. The idom$ variable values are persisted for each node (shared among original, linked 
	// and cloned versions of the populated node) with the key being a combination of the base node 
	// id, instance id (without the link/clone reference) and clone id 
	
	for (n = 0; n < jsonData.teams[2].members.length; n++) {
	
		document.querySelector('[idom-node-id="userInfo"]').idom$('clone3',
			{
				// data is remembered from the last time this instance (with this clone reference) was populated
				
			}, 
			{
				// default mode is replace...
				mode: 'append',
				instanceId: 'user' + n
			})
	
	}
	
	// Perform replace on the host Node inside the clone (linked node gets re/linked with each idom$() call)
	
	// notice that we're only supplying the new/changed data (the delta not the whole set) for the idom$ variables 
	// in the node prototype. The idom$ variable values are persisted for each node (shared among original, linked 
	// and cloned versions of the populated node) with the key being a combination of the base node 
	// id, instance id (without the link/clone reference) and clone id 

	// Since we're doing a replace, no need to delete content with every invocation 
	// When operating on a clone, we discard the cloneId argument
	
	document.querySelector('[idom-node-id="teamInfo@cloned@clone3"]').idom$(
		{
			// data is remembered from the last time this instance (with this clone reference) was populated
				
		}, 
		{
			instanceId: 'teamInfo'
		})	
		
	
}


function borderSelector(instanceId) {
	
	var item = idom.baseSelector(instanceId)
	
	switch(item) {
		
		case 'user0':		
			return '1px dashed white';
		
		case 'user1':
			return '1px dotted white'
			
		case 'user2':
			return '1px solid white'
			
		default: 
			return '1px solid white'
	}	
}

function rndColor() {
    
    return (function(h){return '#000000'.substr(0,7-h.length)+h}) ((~~(Math.random()*(1<<24))).toString(16));
}

</script>


<pre>

&lt;script>
/*********************************************** PRESENTER *************************************************************/

/*************************** ALL SELECTOR DRIVEN LOGIC IS CONTAINED WITHIN THE PRESENTER ***********************************/

//cache DOM elements with idom-node-id (i.e. all node prototypes) and supply values for init() variables (i$var) if any (as simple JSON)
idom.init();	

(function() {
	
	for (m = 0; m &lt; jsonData.teams.length; m++) {
		
	//populate the Node Prototype of the Linked Node before the Host Node 
	 
	for (n = 0; n &lt; jsonData.teams[m].members.length; n++) {
	
	    // the next-level-up linked node is userInfo 
		document.querySelector('[idom-node-id=userInfo]').idom$('clone' + Number(m + 1),
			{
				usersClass: 'users',
				usersProtoClass: 'usersProto',
				usersExtendedClass: 'usersExtended' ,
				borderStyle: 'none',
				displayStatus: 'none',
				bgColorUsers: rndColor(),
				bgColorUsersExtended: rndColor(),
				username: jsonData.teams[m].members[n].username,
				id: jsonData.teams[m].members[n].id,
				lastName: jsonData.teams[m].members[n].otherData.lastName,
				work: jsonData.teams[m].members[n].otherData.work,
				// we can have as many event handlers on or within a node but here we're just using the 
				// same one here, on user's first name and id 
				someHandler: 'idom.eventHandler(event, this, changeInstance)' 
				// event handler can be removed by simply setting someHandler to null
			}, 
			{
				// default mode is replace...
				mode: 'append',
				instanceId: 'user' + n
			})
	
	}
	
	// perform replace on the Host Node (linked node gets re/linked with each idom$() call)
	// and populate again each time before making a new clone of it
	document.querySelector('[idom-node-id=teamInfo]').idom$('clone' + Number(m + 1),
		{
			teamsClass: 'teams' + Number(m + 1),
			teamsProtoClass: 'teamsProto',
			bgColorTeams: rndColor(),
			caption: jsonData.teams[m].caption,
			instanceColorTeams: rndColor() 
		}, 
		{	
			instanceId: 'teamInfo' 
		})		

	// at this point the teamInfo div is populated with the idom$ data and the content of the linked userInfo node 
	// so we may now clone it and provide a uid for the clone (e.g. 'clone1')
	var clonedEl = document.querySelector('[idom-node-id=teamInfo]').idom$clone('clone' + Number(m + 1))

	//insert cloned node into body
	document.querySelector('#mainDiv').appendChild(clonedEl);
	
	// normally, we'd have to call idom$dePopulate() on the host node (so we may start with no instances in the next 
	// iteration) but in this case the host node's only populated instance is being replaced each time (default mode is 
	// 'replace') so no need to dePopulate it
	
	// dePopulate() the linked node so we can restart with new data 
	document.querySelector('[idom-node-id=userInfo]').idom$dePopulate()
	
	}

}())

var toggle = {};

var Instance = {};

// the event handler is defined here on each instance of the linked node that's now inside 
// the cloned node, but it can also be defined anywhere within any node (and anywhere within any linked nodes within
// it) 

// About Events:
// If a handler is defined on the node it will only have access to the node id. If it's defined on or in the
// node prototype it will have access to the instance id

// The context of 'this' inside the handler is the element the event is defined on 

// event handlers that are not defined using inline event handlers (like onclick, onmouseover, etc) are not handled by 
// idom at this time. Finding and cloning all event handlers that are attached via different means, like jQuery, 
// will be supported in the future 

function changeInstance(event, nodeId, instanceId, cloneId) {
	
	// normally, a unique key is the combination of nodeId + instanceId + cloneId 
	// which assumes cloneId is globally unique (user enforced), node is unique within 
	// the clone (framework enforced) and instanceId is unique within the node (user enforced)
	// but in this case the nodeId contains the cloneId so we're safe...
	
	if (Instance[nodeId]) {
		
		document.querySelector('[idom-node-id="' + nodeId + '"]').idom$(
				{
					borderStyle: 'none',
					displayStatus: 'none'
				}, 
				{
					// instanceId in settings is the same as the original populated node 
					// without link/clone references (they're added automatically)
					
				    // new instance id (same as old)
					instanceId: idom.baseSelector(Instance[nodeId]),
					// target instance id (for instance to be replaced) 
					targetInstanceId: idom.baseSelector(Instance[nodeId])
				})
				
				toggle[Instance[nodeId]] = !toggle[Instance[nodeId]];	
				
	} 
	
	Instance[nodeId] = instanceId;
	
	toggle[Instance[nodeId]] = !toggle[Instance[nodeId]];
	
	
	if (toggle[Instance[nodeId]]) {
		
		// notice that we're only supplying the new/changed data (the delta not the whole set) for the idom$ variables 
		// in the node prototype. The idom$ variable values are persisted for each node (shared among original, linked 
		// and cloned versions of the populated node) with the key being a combination of the base node 
		// id, instance id (without the link/clone reference) and clone id 
		
		// directly accessing the linked node inside the cloned node (the linked can be nested anywhere in the
		// node prototype of the original node the clone is copied from)
		// when operating on a clone, we discard the cloneId argument
		
		document.querySelector('[idom-node-id="' + nodeId + '"]').idom$(
				{
					borderStyle: borderSelector(instanceId),
					displayStatus: 'block'
				}, 
				{
					// instanceId in settings is the same as the original populated node 
					// without link/clone references (they're added automatically)
					
				    // new instance id (same as old)
					instanceId: idom.baseSelector(instanceId),
					// target instance id (for instance to be replaced) 
					targetInstanceId: idom.baseSelector(instanceId)
				})
	} else {
		
		document.querySelector('[idom-node-id="' + nodeId + '"]').idom$(
				{
					borderStyle: 'none',
					displayStatus: 'none'
				}, 
				{
					// instanceId in settings is the same as the original populated node 
					// without link/clone references (they're added automatically)
					
					 // new instance id (same as old)
					instanceId: idom.baseSelector(instanceId),
					// target instance id (for instance to be replaced) 
					targetInstanceId: idom.baseSelector(instanceId)
				})
	}
}

function button1() {
	
	// notice that we're only supplying the new/changed data (the delta not the whole set) for the idom$ variables 
	// in the node prototype. The idom$ variable values are persisted for each node (shared among original, linked 
	// and cloned versions of the populated node) with the key being a combination of the base node 
	// id, instance id (without the link/clone reference) and clone id 	
	
	// directly accessing the linked node inside the cloned node (the linked can be nested anywhere in the
	// node prototype of the original node the clone is copied from)
	// when operating on a clone, we discard the cloneId argument
	
	document.querySelector('[idom-node-id="userInfo@cloned@clone2"]').idom$( 
		{
			someHandler: "" //null value removes the handler
		},
		{
			// instanceId in settings is the same as the original populated node 
			// without link/clone references (they're added automatically)
					
			instanceId: "user1",
			targetInstanceId: "user1"
		}
	
	)
}

function button2() {
	
	// notice that we're only supplying the new/changed data (the delta not the whole set) for the idom$ variables 
	// in the node prototype. The idom$ variable values are persisted for each node (shared among original, linked 
	// and cloned versions of the populated node) with the key being a combination of the base node 
	// id, instance id (without the link/clone reference) and clone id 
	
	// directly accessing the linked node inside the cloned node (the linked can be nested anywhere in the
	// node prototype of the original node the clone is copied from)
	// when operating on a clone, we discard the cloneId argument
	
	document.querySelector('[idom-node-id="userInfo@cloned@clone2"]').idom$( 
		{
			someHandler: "idom.eventHandler(event, this, changeInstance)" 
		},
		{
			// instanceId in settings is the same as the original populated node 
			// without link/clone references (they're added automatically)
					
			instanceId: "user1",
			targetInstanceId: "user1"
		}
	
	)
}

function button3() {
	
	// notice that we're only supplying the new/changed data (the delta not the whole set) for the idom$ variables 
	// in the node prototype. The idom$ variable values are persisted for each node (shared among original, linked 
	// and cloned versions of the populated node) with the key being a combination of the base node 
	// id, instance id (without the link/clone reference) and clone id 
	
	// delete content of the cloned node (including content of the cloned linked node)
	document.querySelector('[idom-node-id="teamInfo@cloned@clone3"]').idom$dePopulate()

}

function button4() {
	
	// delete content of the original Linked Node (outside the clone) 
	if (document.querySelector('[idom-node-id="userInfo"]').idom$isPopulated()) 
		document.querySelector('[idom-node-id="userInfo"]').idom$dePopulate()
		
	//Populate the Node Prototype of the original Linked Node  
	
	// notice that we're only supplying the new/changed data (the delta not the whole set) for the idom$ variables 
	// in the node prototype. The idom$ variable values are persisted for each node (shared among original, linked 
	// and cloned versions of the populated node) with the key being a combination of the base node 
	// id, instance id (without the link/clone reference) and clone id 
	
	for (n = 0; n &lt; jsonData.teams[2].members.length; n++) {
	
		document.querySelector('[idom-node-id="userInfo"]').idom$('clone3',
			{
				// data is remembered from the last time this instance (with this clone reference) was populated
				
			}, 
			{
				// default mode is replace...
				mode: 'append',
				instanceId: 'user' + n
			})
	
	}
	
	// Perform replace on the host Node inside the clone (linked node gets re/linked with each idom$() call)
	
	// notice that we're only supplying the new/changed data (the delta not the whole set) for the idom$ variables 
	// in the node prototype. The idom$ variable values are persisted for each node (shared among original, linked 
	// and cloned versions of the populated node) with the key being a combination of the base node 
	// id, instance id (without the link/clone reference) and clone id 

	// Since we're doing a replace, no need to delete content with every invocation 
	// When operating on a clone, we discard the cloneId argument
	
	document.querySelector('[idom-node-id="teamInfo@cloned@clone3"]').idom$(
		{
			// data is remembered from the last time this instance (with this clone reference) was populated
				
		}, 
		{
			instanceId: 'teamInfo'
		})	
		
	
}


function borderSelector(instanceId) {
	
	var item = idom.baseSelector(instanceId)
	
	switch(item) {
		
		case 'user0':		
			return '1px dashed white';
		
		case 'user1':
			return '1px dotted white'
			
		case 'user2':
			return '1px solid white'
			
		default: 
			return '1px solid white'
	}	
}

function rndColor() {
    
    return (function(h){return '#000000'.substr(0,7-h.length)+h}) ((~~(Math.random()*(1&lt;&lt;24))).toString(16));
}

&lt;/script>


	
</pre>
</body>
</html>		


